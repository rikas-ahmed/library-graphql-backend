{"version":3,"file":"PgConnectionArgOrderByDefaultValue.js","names":["PgConnectionArgOrderByDefaultValue","builder","hook","args","build","context","extend","getTypeByName","pgGetGqlTypeByTypeIdAndModifier","inflection","scope","fieldName","isPgFieldConnection","pgFieldIntrospection","table","Self","kind","namespace","isSelectable","orderBy","TableType","type","id","tableTypeName","name","TableOrderByType","orderByType","primaryKeyAsc","builtin","defaultValueEnum","getValues","find","v","defaultValue","value","exports","default"],"sources":["../../src/plugins/PgConnectionArgOrderByDefaultValue.js"],"sourcesContent":["// @flow\nimport type { Plugin } from \"graphile-build\";\n\nexport default (function PgConnectionArgOrderByDefaultValue(builder) {\n  builder.hook(\n    \"GraphQLObjectType:fields:field:args\",\n    (args, build, context) => {\n      const {\n        extend,\n        getTypeByName,\n        pgGetGqlTypeByTypeIdAndModifier,\n        inflection,\n      } = build;\n      const {\n        scope: { fieldName, isPgFieldConnection, pgFieldIntrospection: table },\n        Self,\n      } = context;\n\n      if (\n        !isPgFieldConnection ||\n        !table ||\n        table.kind !== \"class\" ||\n        !table.namespace ||\n        !table.isSelectable ||\n        !args.orderBy\n      ) {\n        return args;\n      }\n      const TableType = pgGetGqlTypeByTypeIdAndModifier(table.type.id, null);\n      const tableTypeName = TableType.name;\n      const TableOrderByType = getTypeByName(\n        inflection.orderByType(tableTypeName)\n      );\n      if (!TableOrderByType) {\n        return args;\n      }\n\n      const primaryKeyAsc = inflection.builtin(\"PRIMARY_KEY_ASC\");\n      const defaultValueEnum =\n        TableOrderByType.getValues().find(v => v.name === primaryKeyAsc) ||\n        TableOrderByType.getValues()[0];\n\n      return extend(args, {\n        orderBy: extend(\n          args.orderBy,\n          {\n            defaultValue: defaultValueEnum && [defaultValueEnum.value],\n          },\n          `Adding defaultValue to orderBy for field '${fieldName}' of '${Self.name}'`\n        ),\n      });\n    },\n    [\"PgConnectionArgOrderByDefaultValue\"]\n  );\n}: Plugin);\n"],"mappings":";;;;;;IAGyBA,kCAAkC,GAA3C,SAASA,kCAAkCA,CAACC,OAAO,EAAE;EACnEA,OAAO,CAACC,IAAI,CACV,qCAAqC,EACrC,CAACC,IAAI,EAAEC,KAAK,EAAEC,OAAO,KAAK;IACxB,MAAM;MACJC,MAAM;MACNC,aAAa;MACbC,+BAA+B;MAC/BC;IACF,CAAC,GAAGL,KAAK;IACT,MAAM;MACJM,KAAK,EAAE;QAAEC,SAAS;QAAEC,mBAAmB;QAAEC,oBAAoB,EAAEC;MAAM,CAAC;MACtEC;IACF,CAAC,GAAGV,OAAO;IAEX,IACE,CAACO,mBAAmB,IACpB,CAACE,KAAK,IACNA,KAAK,CAACE,IAAI,KAAK,OAAO,IACtB,CAACF,KAAK,CAACG,SAAS,IAChB,CAACH,KAAK,CAACI,YAAY,IACnB,CAACf,IAAI,CAACgB,OAAO,EACb;MACA,OAAOhB,IAAI;IACb;IACA,MAAMiB,SAAS,GAAGZ,+BAA+B,CAACM,KAAK,CAACO,IAAI,CAACC,EAAE,EAAE,IAAI,CAAC;IACtE,MAAMC,aAAa,GAAGH,SAAS,CAACI,IAAI;IACpC,MAAMC,gBAAgB,GAAGlB,aAAa,CACpCE,UAAU,CAACiB,WAAW,CAACH,aAAa,CACtC,CAAC;IACD,IAAI,CAACE,gBAAgB,EAAE;MACrB,OAAOtB,IAAI;IACb;IAEA,MAAMwB,aAAa,GAAGlB,UAAU,CAACmB,OAAO,CAAC,iBAAiB,CAAC;IAC3D,MAAMC,gBAAgB,GACpBJ,gBAAgB,CAACK,SAAS,CAAC,CAAC,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACR,IAAI,KAAKG,aAAa,CAAC,IAChEF,gBAAgB,CAACK,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IAEjC,OAAOxB,MAAM,CAACH,IAAI,EAAE;MAClBgB,OAAO,EAAEb,MAAM,CACbH,IAAI,CAACgB,OAAO,EACZ;QACEc,YAAY,EAAEJ,gBAAgB,IAAI,CAACA,gBAAgB,CAACK,KAAK;MAC3D,CAAC,EACA,6CAA4CvB,SAAU,SAAQI,IAAI,CAACS,IAAK,GAC3E;IACF,CAAC,CAAC;EACJ,CAAC,EACD,CAAC,oCAAoC,CACvC,CAAC;AACH,CAAC;AAAAW,OAAA,CAAAC,OAAA,GAAApC,kCAAA"}