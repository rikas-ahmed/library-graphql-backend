{"version":3,"file":"PgOrderByPrimaryKeyPlugin.js","names":["PgOrderByPrimaryKeyPlugin","builder","hook","values","build","context","extend","inflection","scope","isPgRowSortEnum","pgIntrospection","table","kind","primaryKeyConstraint","primaryKeys","keyAttributes","builtin","value","alias","specs","map","key","name","unique","exports","default"],"sources":["../../src/plugins/PgOrderByPrimaryKeyPlugin.js"],"sourcesContent":["// @flow\nimport type { Plugin } from \"graphile-build\";\n\nexport default (function PgOrderByPrimaryKeyPlugin(builder) {\n  builder.hook(\n    \"GraphQLEnumType:values\",\n    (values, build, context) => {\n      const { extend, inflection } = build;\n      const {\n        scope: { isPgRowSortEnum, pgIntrospection: table },\n      } = context;\n\n      if (!isPgRowSortEnum || !table || table.kind !== \"class\") {\n        return values;\n      }\n      const primaryKeyConstraint = table.primaryKeyConstraint;\n      if (!primaryKeyConstraint) {\n        return values;\n      }\n      const primaryKeys = primaryKeyConstraint.keyAttributes;\n\n      return extend(\n        values,\n        {\n          [inflection.builtin(\"PRIMARY_KEY_ASC\")]: {\n            value: {\n              alias: \"primary_key_asc\",\n              specs: primaryKeys.map(key => [key.name, true]),\n              unique: true,\n            },\n          },\n          [inflection.builtin(\"PRIMARY_KEY_DESC\")]: {\n            value: {\n              alias: \"primary_key_desc\",\n              specs: primaryKeys.map(key => [key.name, false]),\n              unique: true,\n            },\n          },\n        },\n        `Adding primary key asc/desc sort to table '${table.name}'`\n      );\n    },\n    [\"PgOrderByPrimaryKey\"]\n  );\n}: Plugin);\n"],"mappings":";;;;;;IAGyBA,yBAAyB,GAAlC,SAASA,yBAAyBA,CAACC,OAAO,EAAE;EAC1DA,OAAO,CAACC,IAAI,CACV,wBAAwB,EACxB,CAACC,MAAM,EAAEC,KAAK,EAAEC,OAAO,KAAK;IAC1B,MAAM;MAAEC,MAAM;MAAEC;IAAW,CAAC,GAAGH,KAAK;IACpC,MAAM;MACJI,KAAK,EAAE;QAAEC,eAAe;QAAEC,eAAe,EAAEC;MAAM;IACnD,CAAC,GAAGN,OAAO;IAEX,IAAI,CAACI,eAAe,IAAI,CAACE,KAAK,IAAIA,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;MACxD,OAAOT,MAAM;IACf;IACA,MAAMU,oBAAoB,GAAGF,KAAK,CAACE,oBAAoB;IACvD,IAAI,CAACA,oBAAoB,EAAE;MACzB,OAAOV,MAAM;IACf;IACA,MAAMW,WAAW,GAAGD,oBAAoB,CAACE,aAAa;IAEtD,OAAOT,MAAM,CACXH,MAAM,EACN;MACE,CAACI,UAAU,CAACS,OAAO,CAAC,iBAAiB,CAAC,GAAG;QACvCC,KAAK,EAAE;UACLC,KAAK,EAAE,iBAAiB;UACxBC,KAAK,EAAEL,WAAW,CAACM,GAAG,CAACC,GAAG,IAAI,CAACA,GAAG,CAACC,IAAI,EAAE,IAAI,CAAC,CAAC;UAC/CC,MAAM,EAAE;QACV;MACF,CAAC;MACD,CAAChB,UAAU,CAACS,OAAO,CAAC,kBAAkB,CAAC,GAAG;QACxCC,KAAK,EAAE;UACLC,KAAK,EAAE,kBAAkB;UACzBC,KAAK,EAAEL,WAAW,CAACM,GAAG,CAACC,GAAG,IAAI,CAACA,GAAG,CAACC,IAAI,EAAE,KAAK,CAAC,CAAC;UAChDC,MAAM,EAAE;QACV;MACF;IACF,CAAC,EACA,8CAA6CZ,KAAK,CAACW,IAAK,GAC3D,CAAC;EACH,CAAC,EACD,CAAC,qBAAqB,CACxB,CAAC;AACH,CAAC;AAAAE,OAAA,CAAAC,OAAA,GAAAzB,yBAAA"}